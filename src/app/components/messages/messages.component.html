<div class="container">
  <div class="section" *ngIf="anOfferExist && isAGroup">
    <div class="container">
      <div class="row">
        <div class="col-md-8">
          <img src="assets/deal.jpg" class="img-responsive">
        </div>
        <div class="col-md-4" style="padding-top: 4px">
          <div class="alert alert-dismissable alert-warning">
            <p><b>Ciao, hai ricevuto un offerta.</b></p>
            <p>Ti ricordiamo che se accetti questa offerta, verrai trasferito sulla pagina
              di Paypal, dove ti verrà chiesto di inserire i dati e di effettuare un
              pagamento. Una volta eseguito il pagamento, potrai annullare il tuo evento
              fino a 7 giorni prima della data per cui è organizzato per non perdere
              i tuoi fondi. Una volta trascorso tale termine, il tuo deposito verrà perso.
              Se effettui il pagamento, stai implicitamente accettando queste condizioni.</p>
              <p>L'offerta che hai ricevuto è di <b>75.00€</b></p>
            </div>
            <p class="text-center">
              <button type="button"class="btn btn-danger btn-outline">Accetta offerta</button>
            </p>
          </div>
        </div>
      </div>
    </div>

    <div class="section">
      <div class="row">
        <div class="col-md-12">
          <h1>Stai messaggiando con fasjidfnan <button type="button" class="btn btn-success btn-outline" (click)="openModal()">Fai un'offerta</button></h1>
        </div>
      </div>
      <div class="row margin-top">
        <div class="col-md-12">
          <ng-container *ngFor="let item of messages">
            <div class="well messages" [ngClass]="{'text-right my-messages': item.sentFrom==2, 'messages his-messages': !(item.sentFrom==2)}">
              <p>{{ item.text }}</p>
              <em>{{ item.sendDate | date:'dd/MM/yyyy HH:mm' }}</em>
            </div>
          </ng-container>
        </div>
      </div>
      <div class="row">
        <div class="form-group col-md-12">
          <label>Messaggio</label>
          <textarea name="text" rows="3" class="form-control" [(ngModel)]="communication.text"></textarea>
        </div>
      </div>
      <div class="row">
        <div class="text-right col-md-12">
          <button type="button" class="btn btn-default" (click)="answer()">Rispondi</button>
          <button type="button" class="btn btn-success btn-outline" (click)="openModal()">Fai un'offerta</button>
        </div>
      </div>
    </div>
  </div>

  <bs-modal #modal>
    <bs-modal-header [showDismiss]="true">
      <h4 class="modal-title">
        <span>Fai un'offerta</span>
      </h4>
    </bs-modal-header>
    <bs-modal-body>
      <div class="alert alert-info">
        <strong>Giusto per chiarezza!</strong>
        Una volta inviata la richiesta, sarà possibile rivedere i dati inseriti riaccedendo di
        nuovo a questa sezione. Ti sarà possibile modificare i dati fino a quando il gruppo non
        accetterà la proposta.
      </div>
      <form #f="ngForm" novalidate>
        <div class="row">
          <div class="col-sm-6 col-xs-12 form-group">
            <label>Nome evento</label>
            <input type="text" name="name" class="form-control" required [(ngModel)]="offer.name">
          </div>
          <div class="col-sm-6 col-xs-12 form-group">
            <label>Data prevista</label>
            <input type="text" class="form-control" bsDatepicker name="eventDate" required [(ngModel)]="offer.date"/>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12 form-group">
            <label>Descrizione</label>
            <textarea name="desription" rows="3" class="form-control" required [(ngModel)]="offer.description"></textarea>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6 col-xs-12 form-group">
            <label>Prezzo</label>
            <input type="text" name="price" class="form-control" [(ngModel)]="offer.price" pattern="[0-9]{1,5}([.][0-9]{0,2})?" required>
          </div>
        </div>
      </form>
    </bs-modal-body>
    <bs-modal-footer>
      <button type="button" class="btn btn-default" data-dismiss="modal" (click)="modal.dismiss()">Annulla</button>
      <button type="button" class="btn btn-primary" (click)="sendOffer()" [disabled]="f.invalid">Invia offerta</button>
    </bs-modal-footer>
  </bs-modal>
